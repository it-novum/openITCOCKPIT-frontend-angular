<oitc-coreui>
  <ng-container *transloco="let t">
    <nav aria-label="breadcrumb">
      <ol class="breadcrumb">
        <li class="breadcrumb-item">
          <a [routerLink]="['/']">
            <fa-icon [icon]="['fas', 'home']"></fa-icon>
            {{ t('Home') }}
          </a></li>
        <li class="breadcrumb-item">
          <a [routerLink]="['/', 'macros', 'index']" *oitcPermission="['macros', 'index']">
            <fa-icon [icon]="['fas', 'dollar']"></fa-icon>
            {{ t('User defined macros') }}
          </a>
        </li>
        <li class="breadcrumb-item active" aria-current="page">
          <fa-icon [icon]="['fas', 'list']"></fa-icon>
          {{ t('Overview') }}
        </li>
      </ol>
    </nav>

    <div class="row">
      <div class="col-12">
        <div class="alert alert-warning">
          <h4 cAlertHeading>
            <fa-icon [icon]="['fas', 'exclamation-triangle']" class="fa-lg"></fa-icon>
            {{ t('Security notice ') }}
          </h4>
          <p>
            {{ t('User defined macros can also be used inside of check commands. This could lead to unwanted code execution.') }}
            <br>
            {{ t('It is recommended to only provide access for a certain group of users to edit commands and user defined macros.') }}
          </p>
        </div>
      </div>
    </div>

    <c-card class="mb-3">
      <c-card-header>
        <h5 cCardTitle>{{ t('Commands overview') }}</h5>
        <c-nav class="card-toolbar card-header-pills">
          <c-nav-item class="px-1">
            <button cButton color="default" class="ripple" size="xs" (click)="loadMacros()">
              <fa-icon [icon]="['fas', 'arrows-rotate']"></fa-icon>
              {{ t('Refresh') }}
            </button>
          </c-nav-item>
          <c-nav-item class="px-1">
            <button cButton color="success" class="ripple" size="xs"
                    *oitcPermission="['macros', 'add']">
              <fa-icon [icon]="['fas', 'plus']"></fa-icon>
              {{ t('New') }}
            </button>
          </c-nav-item>
        </c-nav>
      </c-card-header>
      <c-card-body>

        <table cTable hover striped bordered class="mt-2 mb-0">
          <thead>
          <tr>
            <th scope="col">
              {{ t('Name') }}
            </th>
            <th scope="col">
              {{ t('Value') }}
            </th>
            <th scope="col">
              {{ t('Description') }}
            </th>
            <th scope="col">
              {{ t('Actions') }}
            </th>
          </tr>
          </thead>
          <tbody *ngIf="macros">
          <tr *ngFor="let macro of macros">
            <td class="text-primary code-font">
              {{ macro.name }}
            </td>
            <td>
              <code [ngClass]="{'text-blur': macro.password > 0}">
                {{ macro.value }}
              </code>
            </td>
            <td>{{ macro.description }}</td>

            <td>
              <div class="btn-group btn-group-xs" role="group">
                <button type="button" class="btn btn-primary"
                        [ngClass]="{'btn-danger': macro.password == 0}">

                  <fa-icon [icon]="['fas', 'eye']" *ngIf="macro.password == 1"
                           [title]="'Show value' | transloco"
                           (click)="macro.password = 0"></fa-icon>
                  <fa-icon [icon]="['fas', 'eye-slash']" *ngIf="macro.password == 0"
                           [title]="'Hide value' | transloco"
                           (click)="macro.password = 1"></fa-icon>

                </button>
                <button type="button" class="btn btn-default">
                  <fa-icon [icon]="['fas', 'cog']"></fa-icon>
                </button>
              </div>
            </td>

          </tr>
          </tbody>
        </table>

        <oitc-no-records *ngIf="macros && macros.length === 0"></oitc-no-records>

        <c-container fluid>
          <c-row>
            <c-col class="text-info pt-3 pb-2">
              <fa-icon [icon]="['fas', 'circle-info']"></fa-icon>
              {{ t('Nagios supports up to 256 $USERx$ macros ($USER1$ through $USER256$)') }}
            </c-col>
          </c-row>
        </c-container>
      </c-card-body>
      <c-card-footer>
        &nbsp;
      </c-card-footer>
    </c-card>
  </ng-container>
</oitc-coreui>


