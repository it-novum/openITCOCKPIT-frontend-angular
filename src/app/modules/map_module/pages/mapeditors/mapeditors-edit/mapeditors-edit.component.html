<ng-container *transloco="let t">
    <nav aria-label="breadcrumb" class="mt-3">
        <ol class="breadcrumb">
            <li class="breadcrumb-item">
                <a [routerLink]="['/']">
                    <fa-icon [icon]="['fas', 'home']"></fa-icon>
                    {{ t('Home') }}
                </a></li>
            <li class="breadcrumb-item">
                <fa-icon [icon]="['fas', 'puzzle-piece']"></fa-icon>
                {{ t('Map Module') }}
            </li>
            <li class="breadcrumb-item">
                <a *oitcPermission="['mapmodule', 'maps', 'index']"
                   [routerLink]="['/', 'map_module', 'maps', 'index']">
                    <fa-icon [icon]="['fas', 'map-marker']"></fa-icon>
                    {{ t('Maps') }}
                </a>
            </li>
            <li aria-current="page" class="breadcrumb-item active">
                <fa-icon [icon]="['fas', 'edit']"></fa-icon>
                {{ t('Map editor') }}
            </li>
        </ol>
    </nav>

    <c-card class="mb-3">
        <c-card-header>
            <h5 cCardTitle>
                {{ t('Edit map:') }}

                <small class="fw-300">
                    <!--{{ map.Map.name }}-->
                </small>
            </h5>

            <c-nav class="card-toolbar card-header-pills">

                <c-nav-item class="px-1">
                    <div class="checkbox small-checkbox-label me-1 mt-2">
                        <c-form-check>
                            <input
                                type="checkbox"
                                id="show_helplines"
                                cFormCheckInput
                                name="checkbox"
                                checked="checked"
                                [(ngModel)]="Mapeditor.helplines.enabled"
                            />
                            <label
                                cFormCheckLabel
                                for="show_helplines">
                                <i class="checkbox-primary"></i>
                                {{ t('Show help lines') }}
                            </label>
                        </c-form-check>
                    </div>
                </c-nav-item>
                <c-nav-item class="px-1">
                    <c-dropdown variant="btn-group">
                        <button cButton cDropdownToggle color="default" class="dropdown-button dropdown-btn ripple me-1"
                                size="xs" [caret]="true">
                            <span class="fa-stack helpline-stack-icon">
                                <i class="fas fa-grip-lines fa-stack-1x"></i>
                                <i class="fas fa-grip-lines-vertical"></i>
                            </span>
                            {{ t('Help lines distance') }} - {{ Mapeditor.helplines.size }}
                            <fa-icon [icon]="['fas', 'caret-down']"></fa-icon>
                        </button>
                        <ul cDropdownMenu>
                            <li *ngFor="let size of helplineSizes" (click)="changeHelplinesSize(size)">
                                <a cDropdownItem>{{ size }}x{{ size }}px</a>
                            </li>
                        </ul>
                    </c-dropdown>
                </c-nav-item>

                <c-nav-item class="px-1">
                    <button cButton
                            class="ripple me-1 shadow-0"
                            color="danger"
                            size="xs"
                            [hidden]="Mapeditor.synchronizeGridAndHelplinesSize"
                            (click)="Mapeditor.synchronizeGridAndHelplinesSize = true">
                        <fa-icon [icon]="['fas', 'arrow-left']" class="pe-1"></fa-icon>
                        <fa-icon [icon]="['fas', 'unlink']"></fa-icon>
                        {{ t('Change size automatically') }}
                        <fa-icon [icon]="['fas', 'arrow-right']" class="ps-1"></fa-icon>
                    </button>
                    <button cButton
                            class="ripple me-1 shadow-0"
                            color="success"
                            size="xs"
                            [hidden]="!Mapeditor.synchronizeGridAndHelplinesSize"
                            (click)="Mapeditor.synchronizeGridAndHelplinesSize = false">
                        <fa-icon [icon]="['fas', 'arrow-left']" class="pe-1"></fa-icon>
                        <fa-icon [icon]="['fas', 'unlink']"></fa-icon>
                        {{ t('Change size automatically') }}
                        <fa-icon [icon]="['fas', 'arrow-right']" class="ps-1"></fa-icon>
                    </button>
                </c-nav-item>

                <c-nav-item class="px-1">
                    <div class="checkbox small-checkbox-label me-1 mt-2">
                        <c-form-check>
                            <input
                                type="checkbox"
                                id="grid_enabled"
                                cFormCheckInput
                                name="checkbox"
                                checked="checked"
                                [(ngModel)]="Mapeditor.grid.enabled"
                            />
                            <label
                                cFormCheckLabel
                                for="grid_enabled">
                                <i class="checkbox-primary"></i>
                                {{ t('Enable grid') }}
                            </label>
                        </c-form-check>
                    </div>
                </c-nav-item>
                <c-nav-item class="px-1">
                    <c-dropdown variant="btn-group">
                        <button cButton cDropdownToggle color="default" class="dropdown-button dropdown-btn ripple me-1"
                                size="xs" [caret]="true">
                            <fa-icon [icon]="['fas', 'th']"></fa-icon>
                            {{ t('Grid size') }} - {{ Mapeditor.grid.size }}
                            <fa-icon [icon]="['fas', 'caret-down']"></fa-icon>
                        </button>
                        <ul cDropdownMenu>
                            <li *ngFor="let size of gridSizes" (click)="changeGridSize(size)">
                                <a cDropdownItem>{{ size }}x{{ size }}px</a>
                            </li>
                        </ul>
                    </c-dropdown>
                </c-nav-item>

                <c-nav-item class="px-1">
                    <button [fallbackUrl]="['map_module', 'maps', 'index']" cButton class="ripple"
                            color="default"
                            oitcBackButton
                            size="xs">
                        <fa-icon [icon]="['fas', 'left-long']"></fa-icon>
                        {{ t('Back') }}
                    </button>
                </c-nav-item>

                <c-nav-item class="px-1">
                    <button *oitcPermission="['mapmodule', 'mapeditors', 'view']"
                            [routerLink]="['/', 'map_module', 'mapeditors', 'view']" cButton class="ripple"
                            color="default" size="xs" class="me-1">
                        <fa-icon [icon]="['fas', 'eye']"></fa-icon>
                        {{ t('View') }}
                    </button>
                    <!--<button *oitcPermission="['mapmodule', 'mapeditors', 'view']"
                            [routerLink]="['/', 'map_module', 'mapeditors', 'view', map.Map.id]" cButton class="ripple"
                            color="default" size="xs" class="me-1">
                        <fa-icon [icon]="['fas', 'fa-eye']"></fa-icon>
                        {{ t('View') }}
                    </button>-->
                </c-nav-item>

            </c-nav>

        </c-card-header>
        <c-card-body>


            <oitc-map-canvas [gridSize]="gridSize" [gridEnabled]="Mapeditor.grid.enabled"
                             [helplinesEnabled]="Mapeditor.helplines.enabled"
                             [helplinesSize]="Mapeditor.helplines.size">
                <oitc-map-item [position]="{ x: 24, y: 24 }" [itemId]="0" [mapId]="'1'"
                               (dropItemEvent)="onDropItem($event)">
                    <oitc-map-item-content>
                        <img src="./assets/images/docs/browser_notification_bg.png" height="200px" width="200px"
                             draggable="false">
                    </oitc-map-item-content>
                    <oitc-map-item-label>
                        I'm a node Layer 0
                    </oitc-map-item-label>
                </oitc-map-item>
                <oitc-map-item [position]="{ x: 900, y: 24 }" [itemId]="1" [mapId]="'1'"
                               (dropItemEvent)="onDropItem($event)">
                    <oitc-map-item-content>
                        <img src="./assets/images/docs/browser_notification_bg.png" height="200px" width="200px"
                             draggable="false">
                    </oitc-map-item-content>
                    <oitc-map-item-label>
                        I'm a node Layer 1
                    </oitc-map-item-label>
                </oitc-map-item>
            </oitc-map-canvas>

        </c-card-body>
    </c-card>
</ng-container>
